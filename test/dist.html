<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>M2E Test Suite</title>
  <link rel="stylesheet" href="vendor/qunit-1.10.0.css" type="text/css" media="screen">
</head>
<body>
  <div id="qunit"></div>
  <script src="../dist/M2E-0.1.0.js"></script>

  <script src="vendor/qunit-1.10.0.js"></script>

  <script>
    test('m2e instance', function() {
      var worker = new Worker('worker_2.js?fu_cache=' + (+new Date()));

      var m2e = new M2E();
      m2e.sendMessage = worker.postMessage.bind(worker);
      worker.onmessage = function(event) {
        m2e.onmessage(event.data);
      };

      var p1 = 'abc', p2 = 'def';
      m2e.listen('customEvt', function(arg1, arg2) {
        ok(arg1 == p1);
        ok(arg2 == p2);
        start();
      });
      m2e.fire('echo', p1, p2);

      expect(2);
      stop();
    });
  </script>
</body>
</html>
